<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sampler - SampleStudio</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect x='10' y='30' width='80' height='50' rx='5' fill='%23667eea'/><rect x='20' y='40' width='12' height='30' rx='2' fill='white'/><rect x='36' y='40' width='12' height='30' rx='2' fill='white'/><rect x='52' y='40' width='12' height='30' rx='2' fill='white'/><rect x='68' y='40' width='12' height='30' rx='2' fill='white'/></svg>">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Navigation -->
    <nav class="main-nav">
        <div class="nav-brand">
            <span class="logo"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="6" width="20" height="14" rx="2"/><line x1="6" y1="10" x2="6" y2="16"/><line x1="10" y1="10" x2="10" y2="16"/><line x1="14" y1="10" x2="14" y2="16"/><line x1="18" y1="10" x2="18" y2="16"/></svg></span>
            <span class="brand-name">SampleStudio</span>
        </div>
        <div class="nav-links">
            <a href="/home.html" class="nav-link">Home</a>
            <a href="/sampler.html" class="nav-link active">Sampler</a>
            <a href="/manager" class="nav-link">Preset Manager</a>
        </div>
        <div id="auth-nav" class="auth-nav">
            <!-- Auth navigation will be injected by auth.js -->
        </div>
    </nav>

    <div class="container sampler-container">
        <header>
            <canvas id="visualizer"></canvas>
        </header>

        <main>
            <!-- Preset Controls -->
            <div id="preset-controls">
                <select id="preset-select">
                    <option value="">-- Select a Preset --</option>
                </select>
                <button id="load-btn" disabled>Load Preset</button>
                <button id="stop-all-btn" title="Stop all playing sounds"><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><rect x="4" y="4" width="16" height="16" rx="2"/></svg> Stop All</button>
                <a href="/manager/presets/new" class="create-preset-link" title="Create new preset in manager">+ New</a>
            </div>

            <!-- Loading Progress -->
            <div id="loading-container" class="hidden">
                <div id="loading-text">Loading sounds... 0/0</div>
                <div id="progress-bar">
                    <div id="progress-fill"></div>
                </div>
            </div>

            <div id="pad-container"></div>

            <!-- Waveform Visualization with Trim -->
            <div id="waveform-container">
                <div id="waveform-label">Select a pad to view waveform</div>
                <canvas id="waveform"></canvas>
                <div id="trim-values">
                    <span id="trim-start-display">Start: 0%</span>
                    <span id="trim-end-display">End: 100%</span>
                </div>
            </div>

            <!-- Pad Settings Panel - appears when pad is selected -->
            <div id="pad-settings" class="hidden">
                <div class="settings-header">
                    <h3><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg> Pad <span id="settings-pad-number">0</span> Settings</h3>
                    <button id="reset-pad-settings" class="reset-btn" title="Reset to defaults"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/></svg> Reset</button>
                </div>
                
                <div class="settings-grid">
                    <!-- Play Mode & Loop -->
                    <div class="setting-group">
                        <label>Play Mode</label>
                        <div class="toggle-group">
                            <button class="mode-btn active" data-mode="oneshot" title="Play full sample once">One-Shot</button>
                            <button class="mode-btn" data-mode="gate" title="Play while key/pad held">Gate</button>
                        </div>
                    </div>
                    
                    <div class="setting-group">
                        <label>Loop</label>
                        <div class="toggle-switch">
                            <input type="checkbox" id="loop-toggle">
                            <label for="loop-toggle" class="switch-label">
                                <span class="switch-off">Off</span>
                                <span class="switch-on">On</span>
                            </label>
                        </div>
                    </div>

                    <!-- Volume -->
                    <div class="setting-group full-width">
                        <label>Volume <span id="volume-value">100%</span></label>
                        <input type="range" id="volume-slider" min="0" max="100" value="100" class="styled-slider">
                    </div>

                    <!-- Pitch/Speed -->
                    <div class="setting-group full-width">
                        <label>Pitch/Speed <span id="pitch-value">1.00x</span></label>
                        <input type="range" id="pitch-slider" min="25" max="200" value="100" class="styled-slider pitch-slider">
                        <div class="pitch-marks">
                            <span>0.25x</span>
                            <span>1x</span>
                            <span>2x</span>
                        </div>
                    </div>

                    <!-- Reverse -->
                    <div class="setting-group">
                        <label>Reverse</label>
                        <div class="toggle-switch">
                            <input type="checkbox" id="reverse-toggle">
                            <label for="reverse-toggle" class="switch-label">
                                <span class="switch-off">Off</span>
                                <span class="switch-on">◀◀</span>
                            </label>
                        </div>
                    </div>

                    <!-- Attack -->
                    <div class="setting-group">
                        <label>Attack <span id="attack-value">10ms</span></label>
                        <input type="range" id="attack-slider" min="1" max="500" value="10" class="styled-slider small-slider">
                    </div>

                    <!-- Release -->
                    <div class="setting-group">
                        <label>Release <span id="release-value">100ms</span></label>
                        <input type="range" id="release-slider" min="1" max="2000" value="100" class="styled-slider small-slider">
                    </div>
                </div>
            </div>

            <!-- Recording Controls -->
            <div id="recording-controls">
                <div class="record-header">
                    <h3><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></svg> Quick Record</h3>
                    <div id="record-status" class="hidden">Recording...</div>
                </div>
                <div class="record-actions">
                    <select id="record-pad-select">
                        <option value="0">Pad 0</option>
                        <option value="1">Pad 1</option>
                        <option value="2">Pad 2</option>
                        <option value="3">Pad 3</option>
                        <option value="4">Pad 4</option>
                        <option value="5">Pad 5</option>
                        <option value="6">Pad 6</option>
                        <option value="7">Pad 7</option>
                        <option value="8">Pad 8</option>
                        <option value="9">Pad 9</option>
                        <option value="10">Pad 10</option>
                        <option value="11">Pad 11</option>
                        <option value="12">Pad 12</option>
                        <option value="13">Pad 13</option>
                        <option value="14">Pad 14</option>
                        <option value="15">Pad 15</option>
                    </select>
                    <button id="record-btn"><span class="record-dot"></span> Record</button>
                </div>
            </div>

            <!-- Upload Controls -->
            <div id="upload-controls">
                <div class="record-header">
                    <h3><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg> Quick Upload</h3>
                </div>
                <div class="record-actions">
                    <select id="upload-pad-select">
                        <option value="0">Pad 0</option>
                        <option value="1">Pad 1</option>
                        <option value="2">Pad 2</option>
                        <option value="3">Pad 3</option>
                        <option value="4">Pad 4</option>
                        <option value="5">Pad 5</option>
                        <option value="6">Pad 6</option>
                        <option value="7">Pad 7</option>
                        <option value="8">Pad 8</option>
                        <option value="9">Pad 9</option>
                        <option value="10">Pad 10</option>
                        <option value="11">Pad 11</option>
                        <option value="12">Pad 12</option>
                        <option value="13">Pad 13</option>
                        <option value="14">Pad 14</option>
                        <option value="15">Pad 15</option>
                    </select>
                    <input type="file" id="upload-file-input" accept="audio/*" style="display: none;">
                    <button id="upload-btn"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg> Load File</button>
                </div>
            </div>

            <!-- Track Recording Controls -->
            <div id="track-recording-controls">
                <div class="record-header">
                    <h3><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polygon points="10 8 16 12 10 16 10 8"/></svg> Track Recording</h3>
                    <div id="track-record-time">00:00</div>
                </div>
                <div class="track-record-info">
                    <span>Record your sampler performance as an audio track</span>
                </div>
                <div class="track-record-actions">
                    <button id="track-record-btn" class="track-btn"><span class="record-dot"></span> Start Recording</button>
                    <button id="track-play-btn" class="track-btn" disabled><svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21 5 3"/></svg> Play</button>
                    <button id="track-download-btn" class="track-btn" disabled><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg> Download</button>
                </div>
            </div>

            <!-- Keyboard Mapping Overlay -->
            <div id="keyboard-overlay" class="hidden">
                <div class="overlay-content">
                    <button id="keyboard-close-btn" class="close-btn">×</button>
                    <h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="4" width="20" height="16" rx="2"/><line x1="6" y1="8" x2="6" y2="8"/><line x1="10" y1="8" x2="10" y2="8"/><line x1="14" y1="8" x2="14" y2="8"/><line x1="18" y1="8" x2="18" y2="8"/><rect x="5" y="12" width="14" height="4" rx="1"/></svg> Keyboard Mapping</h3>
                    <div class="keyboard-grid">
                        <div class="key-row">
                            <span class="key" data-pad="0">1<small>Pad 0</small></span>
                            <span class="key" data-pad="1">2<small>Pad 1</small></span>
                            <span class="key" data-pad="2">3<small>Pad 2</small></span>
                            <span class="key" data-pad="3">4<small>Pad 3</small></span>
                        </div>
                        <div class="key-row">
                            <span class="key" data-pad="4">Q<small>Pad 4</small></span>
                            <span class="key" data-pad="5">W<small>Pad 5</small></span>
                            <span class="key" data-pad="6">E<small>Pad 6</small></span>
                            <span class="key" data-pad="7">R<small>Pad 7</small></span>
                        </div>
                        <div class="key-row">
                            <span class="key" data-pad="8">A<small>Pad 8</small></span>
                            <span class="key" data-pad="9">S<small>Pad 9</small></span>
                            <span class="key" data-pad="10">D<small>Pad 10</small></span>
                            <span class="key" data-pad="11">F<small>Pad 11</small></span>
                        </div>
                        <div class="key-row">
                            <span class="key" data-pad="12">Z<small>Pad 12</small></span>
                            <span class="key" data-pad="13">X<small>Pad 13</small></span>
                            <span class="key" data-pad="14">C<small>Pad 14</small></span>
                            <span class="key" data-pad="15">V<small>Pad 15</small></span>
                        </div>
                    </div>
                    <p class="overlay-tip">Press any key to trigger the corresponding pad</p>
                </div>
            </div>

            <!-- Test button for loading samples -->
            <div id="test-section">
                <button id="test-btn"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="5.5" cy="17.5" r="2.5"/><circle cx="17.5" cy="15.5" r="2.5"/><circle cx="12" cy="8" r="2.5"/><line x1="8" y1="17" x2="15" y2="16"/><line x1="7" y1="15" x2="10" y2="10"/><line x1="14" y1="10" x2="17" y2="13"/></svg> Load Test Sounds</button>
            </div>
        </main>
    </div>

    <!-- Scripts -->
    <script src="js/auth.js"></script>
    <script src="js/audioEngine.js"></script>
    <script src="js/visualizer.js"></script>
    <script src="js/gui.js"></script>
    <script src="js/app.js"></script>
</body>

</html>
